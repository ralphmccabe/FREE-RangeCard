<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tactical Range Card Free</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#22c55e">
    <script src="tailwind.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">
    <script src="html2canvas.min.js"></script>
    <script src="lucide.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        :root {
            --accent-color: #22c55e;
            --accent-rgb: 34, 197, 94;
            --neon-green: var(--accent-color);
        }

        .font-handwriting {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        .bg-grid-pattern {
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.05) 1px, transparent 0);
            background-size: 20px 20px;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--neon-green);
        }

        .section-label {
            display: block;
            font-size: 10px;
            font-weight: 800;
            color: #4b5563;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
            border-bottom: 1px solid #1f2937;
            padding-bottom: 0.25rem;
        }

        .input-field {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #374151;
            border-radius: 4px;
            padding: 0.5rem;
            font-size: 12px;
            color: white;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--neon-green);
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.2);
        }

        /* Raise recorded text on the card for better alignment */
        #card-container span[id^="display-"] {
            display: inline-block;
            transform: translateY(-3px);
            line-height: normal;
        }

        /* Ensure header note specifically is also raised */
        #card-container #display-header-notes {
            transform: translateY(-4px);
        }
    </style>
</head>

<body
    class="bg-gray-800 text-gray-100 min-h-screen font-sans selection:bg-neon-green selection:text-black overflow-x-hidden">

    <!-- Mobile View Toggle (Floating Action Button) -->
    <button id="mobileViewToggle"
        class="lg:hidden fixed bottom-6 right-6 z-[100] bg-neon-green text-black p-4 rounded-full shadow-2xl flex items-center justify-center active:scale-95 transition-all">
        <i id="toggleIcon" data-lucide="eye" class="w-6 h-6"></i>
    </button>

    <div id="mainLayout" class="flex flex-col lg:flex-row h-screen lg:overflow-hidden">
        <!-- LEFT PANEL: CONTROLS & INPUTS -->
        <aside
            class="w-full lg:w-1/3 bg-gray-900 border-r border-gray-700 flex flex-col h-full overflow-hidden shadow-2xl relative z-10">
            <div class="p-6 border-b border-gray-700 bg-gray-900 z-30 shrink-0">
                <h1
                    class="text-2xl font-bold tracking-tighter text-neon-green uppercase flex items-center gap-2 relative">
                    <i data-lucide="crosshair" class="w-6 h-6 text-neon-green"></i>
                    <span class="text-neon-green">Range Data <span
                            class="text-gray-500 font-normal text-xs lowercase italic">/ Free version</span></span>
                </h1>
                <p class="text-xs text-gray-500 mt-1 uppercase tracking-widest flex justify-between items-center">
                    <span>Ballistics & Environment Log</span>
                    <span id="save-status" class="text-neon-green font-bold text-[8px] animate-pulse"></span>
                </p>
            </div>

            <!-- Scrollable Form Area -->
            <div class="flex-1 overflow-y-auto p-6 pb-40 space-y-8 custom-scrollbar">

                <!-- Profile Manager -->
                <div class="space-y-4">
                    <label class="section-label">Data Management</label>
                    <div class="grid grid-cols-2 gap-2">
                        <button id="openLibraryBtn"
                            class="flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded p-2 text-xs font-bold flex items-center justify-center gap-2 transition-all">
                            <i data-lucide="library" class="w-4 h-4 text-neon-green"></i>
                            OPEN LIBRARY
                        </button>
                        <button id="saveProfileBtnManual"
                            class="flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded p-2 text-xs font-bold flex items-center justify-center gap-2 transition-all">
                            <i data-lucide="save" class="w-4 h-4 text-blue-400"></i>
                            SAVE CURRENT
                        </button>
                        <button id="clearFormBtn"
                            class="col-span-2 bg-red-950/20 hover:bg-red-900/40 border border-red-900/40 hover:border-red-500 rounded p-2 text-xs font-bold text-red-500 hover:text-white flex items-center justify-center gap-2 transition-all mt-1">
                            <i data-lucide="refresh-ccw" class="w-4 h-4"></i>
                            CLEAR ALL DATA
                        </button>
                        <button id="colorCycleBtn"
                            class="col-span-2 bg-blue-950/20 hover:bg-blue-900/40 border border-blue-900/40 hover:border-blue-500 rounded p-2 text-xs font-bold text-blue-400 hover:text-white flex items-center justify-center gap-2 transition-all mt-1 uppercase">
                            <i data-lucide="palette" class="w-4 h-4"></i>
                            Change Color on Screen
                        </button>
                    </div>
                </div>

                <!-- Hidden elements for state -->
                <select id="profileSelect" class="hidden"></select>
                <button id="deleteProfileBtn" class="hidden"></button>

                <!-- Session Info Form -->
                <section class="space-y-4">
                    <label class="section-label">Session Info</label>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-2"><input type="text" id="header-notes" class="input-field"
                                placeholder="Header Notes"></div>
                        <div class="col-span-2"><input type="text" id="shooter-name" class="input-field"
                                placeholder="Shooter Name / Company"></div>
                        <div class="col-span-1"><input type="date" id="date" class="input-field" placeholder="Date">
                        </div>
                        <div class="col-span-1"><input type="time" id="time" class="input-field" placeholder="Time">
                        </div>
                    </div>

                    <label class="section-label">Reload Data</label>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-1"><input type="text" id="caliber" class="input-field"
                                placeholder="Caliber"></div>
                        <div class="col-span-1"><input type="text" id="zero" class="input-field" placeholder="Zero">
                        </div>
                        <div class="col-span-1"><input type="text" id="barrel" class="input-field" placeholder="Barrel">
                        </div>
                        <div class="col-span-1"><input type="text" id="bullet" class="input-field" placeholder="Bullet">
                        </div>
                        <div class="col-span-1"><input type="text" id="load" class="input-field"
                                placeholder="Load (gr)"></div>
                        <div class="col-span-1"><input type="text" id="powder" class="input-field" placeholder="Powder">
                        </div>
                        <div class="col-span-1"><input type="text" id="primer" class="input-field" placeholder="Primer">
                        </div>
                        <div class="col-span-1"><input type="text" id="col" class="input-field" placeholder="C.O.L">
                        </div>
                        <div class="col-span-1"><input type="text" id="rings" class="input-field border-orange-500/30"
                                placeholder="Rings">
                        </div>
                        <div class="col-span-1"><input type="text" id="velocity" class="input-field"
                                placeholder="Velocity"></div>
                        <div class="col-span-1"><input type="text" id="g1" class="input-field" placeholder="G-1 / BC">
                        </div>
                        <div class="col-span-1"><input type="text" id="weather" class="input-field"
                                placeholder="Weather"></div>
                        <div class="col-span-1"><input type="text" id="elevation" class="input-field"
                                placeholder="Elevation"></div>
                        <div class="col-span-1"><input type="text" id="hold-data" class="input-field"
                                placeholder="Hold"></div>
                        <div class="col-span-2"><input type="text" id="final-dope"
                                class="input-field border-neon-green/50" placeholder="Final DOPE"></div>
                        <div class="col-span-2"><input type="text" id="rifle-notes" class="input-field"
                                placeholder="Rifle / Equipment Notes"></div>
                    </div>
                </section>

                <!-- Target Data Form -->
                <section class="space-y-4">
                    <label class="section-label">Target Data</label>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-1"><input type="text" id="targetSize" class="input-field"
                                placeholder="Target Size"></div>
                        <div class="col-span-1"><input type="text" id="groupSize" class="input-field"
                                placeholder="Group Size"></div>
                        <div class="col-span-1"><input type="text" id="wind-notes" class="input-field"
                                placeholder="Wind Notes"></div>
                        <div class="col-span-1"><input type="text" id="scope-notes" class="input-field"
                                placeholder="Scope Settings"></div>
                        <div class="col-span-1"><input type="text" id="lrf-notes" class="input-field"
                                placeholder="LRF Notes"></div>
                        <div class="col-span-1"><input type="text" id="direction-notes" class="input-field"
                                placeholder="Direction / LOS"></div>
                    </div>

                    <label class="section-label">Compass / Map</label>

                    <div class="space-y-2">
                        <div class="grid grid-cols-2 gap-2">
                            <input type="text" id="shooting-angle" class="input-field" placeholder="T1 Angle">
                            <input type="text" id="compass-range" class="input-field" placeholder="T1 Range">
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <input type="text" id="shooting-angle-2" class="input-field" placeholder="T2 Angle">
                            <input type="text" id="compass-range-2" class="input-field" placeholder="T2 Range">
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <input type="text" id="shooting-angle-3" class="input-field" placeholder="T3 Angle">
                            <input type="text" id="compass-range-3" class="input-field" placeholder="T3 Range">
                        </div>
                    </div>

                    <div class="bg-gray-900 border border-gray-800 rounded p-2 flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="pencil-toggle" class="w-4 h-4 accent-neon-green">
                            <span class="text-[10px] font-bold uppercase text-gray-400">Pencil
                                Tool</span>
                        </div>
                        <div class="flex gap-1">
                            <button id="clear-pencil" class="p-1 hover:text-red-500 rounded"><i data-lucide="trash-2"
                                    class="w-4 h-4"></i></button>
                            <button id="clear-hold-btn"
                                class="bg-gray-800 text-[8px] px-2 py-1 rounded uppercase font-bold border border-gray-700 hover:bg-gray-700 transition-colors">Clear
                                Hold</button>
                            <button id="clear-shot-btn"
                                class="bg-gray-800 text-[8px] px-2 py-1 rounded uppercase font-bold border border-gray-700 hover:bg-gray-700 transition-colors">Clear
                                Shot</button>
                        </div>
                    </div>
                </section>

                <!-- Distance Data Section -->
                <section class="space-y-4">
                    <label class="section-label group flex items-center gap-2 cursor-pointer"
                        onclick="document.getElementById('distanceForm').classList.toggle('hidden')">
                        <i data-lucide="chevron-down" class="w-4 h-4"></i>
                        Distance Data (100 - 1000)
                    </label>
                    <div id="distanceForm" class="hidden space-y-2">
                        <div class="grid grid-cols-3 gap-2 text-[8px] font-bold text-gray-600 uppercase mb-2 px-1">
                            <div>Dist</div>
                            <div>Clicks</div>
                            <div>UD-LR</div>
                        </div>
                        <div class="space-y-1 max-h-60 overflow-y-auto custom-scrollbar pr-2">
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-100" class="input-field py-1 text-center" value="100">
                                <input type="text" id="clicks-100" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-100" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-200" class="input-field py-1 text-center" value="200">
                                <input type="text" id="clicks-200" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-200" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-300" class="input-field py-1 text-center" value="300">
                                <input type="text" id="clicks-300" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-300" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-400" class="input-field py-1 text-center" value="400">
                                <input type="text" id="clicks-400" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-400" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-500" class="input-field py-1 text-center" value="500">
                                <input type="text" id="clicks-500" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-500" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-600" class="input-field py-1 text-center" value="600">
                                <input type="text" id="clicks-600" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-600" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-700" class="input-field py-1 text-center" value="700">
                                <input type="text" id="clicks-700" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-700" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-800" class="input-field py-1 text-center" value="800">
                                <input type="text" id="clicks-800" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-800" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-900" class="input-field py-1 text-center" value="900">
                                <input type="text" id="clicks-900" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-900" class="input-field py-1" placeholder="UDLR">
                            </div>
                            <div class="grid grid-cols-3 gap-2 items-center bg-black/20 p-1 rounded">
                                <input type="text" id="dist-1000" class="input-field py-1 text-center" value="1000">
                                <input type="text" id="clicks-1000" class="input-field py-1" placeholder="Clicks">
                                <input type="text" id="udlr-1000" class="input-field py-1" placeholder="UDLR">
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Calculator -->
                <section class="bg-gray-900 border border-gray-800 rounded p-4 space-y-2">
                    <label class="section-label flex items-center gap-2"><i data-lucide="calculator"
                            class="w-3 h-3 text-neon-green"></i> Calculator</label>
                    <input type="text" id="calc-display"
                        class="w-full bg-black text-right p-3 rounded font-mono text-neon-green text-xl border border-gray-800 mb-2"
                        readonly value="0">
                    <div class="grid grid-cols-4 gap-1">
                        <button class="bg-red-900/40 text-red-500 p-2 rounded text-xs font-bold"
                            onclick="clearCalc()">C</button>
                        <button class="bg-gray-800 p-2 rounded text-xs" onclick="appendCalc('/')">/</button>
                        <button class="bg-gray-800 p-2 rounded text-xs" onclick="appendCalc('*')">×</button>
                        <button class="bg-blue-900/40 text-blue-400 p-2 rounded text-[10px] font-bold"
                            onclick="calcCos()">COS</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('7')">7</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('8')">8</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('9')">9</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('-')">-</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('4')">4</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('5')">5</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('6')">6</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('+')">+</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('1')">1</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('2')">2</button>
                        <button class="bg-gray-800 p-2 rounded text-sm" onclick="appendCalc('3')">3</button>
                        <button
                            class="bg-gray-900 p-2 rounded text-sm border border-neon-green/30 text-neon-green row-span-2 font-bold"
                            onclick="executeCalc()">=</button>
                        <button class="bg-gray-800 p-2 rounded text-sm col-span-2" onclick="appendCalc('0')">0</button>
                        <button class="bg-gray-800 p-2 rounded text-sm font-bold" onclick="appendCalc('.')">.</button>
                    </div>
                </section>

                <div class="pt-4">
                    <button id="downloadBtn"
                        class="w-full bg-neon-green text-white font-extrabold py-4 rounded-lg hover:shadow-[0_0_20px_rgba(34,197,94,0.4)] transition-all uppercase tracking-widest text-sm flex items-center justify-center gap-3">
                        <i data-lucide="download"></i> Download Card Image
                    </button>
                </div>

                <!-- NEW: Mobile Live Preview Sections (Vertical "Screenshots") -->
                <div id="mobile-live-cards" class="space-y-6 mt-8 border-t border-gray-700 pt-8">

                    <!-- 1. Header Section -->
                    <div class="bg-white text-black p-4 rounded shadow-lg font-mono overflow-hidden">
                        <div class="flex justify-between items-end border-b-2 border-black pb-2 mb-2">
                            <!-- Left: Title & Notes -->
                            <div class="flex flex-col justify-end">
                                <h2 class="text-2xl font-extrabold uppercase tracking-tighter leading-none mb-1">Reload
                                    Data</h2>
                                <div class="text-xs font-bold flex items-center gap-2">
                                    <span>NOTES :</span>
                                    <span id="mobile-display-header-notes"
                                        class="font-handwriting text-blue-800 font-normal truncate max-w-[120px]"></span>
                                </div>
                            </div>

                            <!-- Right: Shooter Info -->
                            <div class="flex flex-col items-end pb-1">
                                <span
                                    class="text-[8px] font-bold text-gray-500 uppercase tracking-widest leading-none mb-1">Shooter
                                    / Company</span>
                                <span id="mobile-display-shooter-name"
                                    class="font-handwriting text-blue-800 font-bold text-sm leading-none text-right"></span>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Data Grid Section -->
                    <div
                        class="bg-white text-black p-4 rounded shadow-lg font-mono text-[10px] font-bold overflow-hidden">
                        <div class="grid grid-cols-[1.4fr_0.8fr_0.8fr] gap-x-2 gap-y-1">
                            <div class="flex flex-col">
                                <span class="text-[8px] text-gray-500 uppercase">Timestamp</span>
                                <div class="flex gap-1 min-h-[1rem]">
                                    <span id="mobile-display-date" class="text-blue-800 font-normal"></span>
                                    <span class="text-gray-400">@</span>
                                    <span id="mobile-display-time" class="text-blue-800 font-normal"></span>
                                </div>
                            </div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">Zero
                                    Range</span><span id="mobile-display-zero" class="text-blue-800 font-normal"></span>
                            </div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Caliber</span><span
                                    id="mobile-display-caliber" class="text-blue-800 font-normal"></span></div>

                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Bullet</span><span
                                    id="mobile-display-bullet" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Barrel</span><span
                                    id="mobile-display-barrel" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Powder</span><span
                                    id="mobile-display-powder" class="text-blue-800 font-normal"></span></div>

                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">Load
                                    (gr)</span><span id="mobile-display-load" class="text-blue-800 font-normal"></span>
                            </div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">C.O.L</span><span id="mobile-display-col"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Primer</span><span
                                    id="mobile-display-primer" class="text-blue-800 font-normal"></span></div>

                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Velocity</span><span
                                    id="mobile-display-velocity" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Target</span><span
                                    id="mobile-display-targetSize" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">G-1
                                    BC</span><span id="mobile-display-g1" class="text-blue-800 font-normal"></span>
                            </div>

                            <div class="flex flex-col col-span-2"><span
                                    class="text-[8px] text-gray-500 uppercase">Environment</span><span
                                    id="mobile-display-weather" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col col-span-1"><span
                                    class="text-[8px] text-gray-500 uppercase">Rings</span><span
                                    id="mobile-display-rings" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col col-span-3"><span
                                    class="text-[8px] text-gray-500 uppercase">Group</span><span
                                    id="mobile-display-groupSize" class="text-blue-800 font-normal"></span></div>
                        </div>
                    </div>

                    <!-- 3. Observations & Equipment (Icons + Elev Box) -->
                    <div
                        class="bg-white text-black p-4 rounded shadow-lg font-mono overflow-hidden flex flex-col gap-4">
                        <!-- Elev Box -->
                        <div
                            class="grid grid-cols-2 gap-4 bg-gray-50 p-2 border border-black rounded-sm text-[10px] font-bold">
                            <div class="flex justify-between"><span>ELEV:</span> <span id="mobile-display-elevation"
                                    class="text-blue-800"></span></div>
                            <div class="flex justify-between"><span>HOLD:</span> <span id="mobile-display-hold-data"
                                    class="text-blue-800"></span></div>
                            <div
                                class="col-span-2 flex justify-between items-center bg-black text-white px-2 py-1 mt-1">
                                <span class="text-[10px] font-bold text-neon-green">FINAL DOPE:</span>
                                <span id="mobile-display-final-dope" class="text-sm font-bold"></span>
                            </div>
                        </div>

                        <!-- Icons List -->
                        <div class="flex flex-col gap-2">
                            <div class="flex items-center gap-2 border border-black p-1">
                                <img src="https://img.icons8.com/ios-filled/50/000000/sniper-rifle.png" alt="Rifle"
                                    class="w-4 h-4 opacity-40">
                                <span id="mobile-display-rifle-notes" class="text-[10px]"></span>
                            </div>
                            <div class="flex items-center gap-2 border border-black p-1">
                                <i data-lucide="wind" class="w-3 h-3 text-gray-400"></i>
                                <span id="mobile-display-wind-notes" class="text-[10px]"></span>
                            </div>
                            <div class="flex items-center gap-2 border border-black p-1">
                                <i data-lucide="crosshair" class="w-3 h-3 text-gray-400"></i>
                                <span id="mobile-display-scope-notes" class="text-[10px]"></span>
                            </div>
                            <div class="flex items-center gap-2 border border-black p-1">
                                <i data-lucide="binoculars" class="w-3 h-3 text-gray-400"></i>
                                <span id="mobile-display-lrf-notes" class="text-[10px]"></span>
                            </div>
                            <div class="flex items-center gap-2 border border-black p-1">
                                <i data-lucide="compass" class="w-3 h-3 text-gray-400"></i>
                                <span id="mobile-display-compass-range" class="text-[10px]"></span>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Reticles (Hold / Shot) -->
                    <div class="bg-white text-black p-4 rounded shadow-lg font-mono overflow-hidden">
                        <div class="flex gap-2 justify-center">
                            <div class="text-center">
                                <p class="text-[10px] font-bold mb-1">HOLD</p>
                                <canvas id="mobile-canvas-hold" width="140" height="140"
                                    class="border border-black rounded-full bg-white"></canvas>
                            </div>
                            <div class="text-center">
                                <p class="text-[10px] font-bold mb-1">SHOT</p>
                                <canvas id="mobile-canvas-shot" width="140" height="140"
                                    class="border border-black rounded-full bg-white"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Footer (Table + Compass) -->
                    <div
                        class="bg-white text-black p-4 rounded shadow-lg font-mono overflow-hidden flex flex-col gap-4">
                        <!-- Table -->
                        <div class="border-2 border-black flex flex-col">
                            <div class="grid grid-cols-4 bg-black text-white font-bold text-center text-[10px] py-1">
                                <div class="border-r border-gray-600">CLICKS</div>
                                <div class="col-span-2 border-r border-gray-600">RANGE</div>
                                <div>UD-LR</div>
                            </div>
                            <div id="mobile-distance-table-body" class="flex-col text-[10px] font-bold">
                                <!-- Injected by script -->
                            </div>
                        </div>

                        <!-- Compass -->
                        <div class="relative border border-black bg-gray-50/50 h-[250px] overflow-hidden">
                            <div class="absolute inset-0 flex items-center justify-center pointer-events-none z-0">
                                <div
                                    class="w-20 h-20 border border-gray-200 rounded-full flex items-center justify-center">
                                    <p class="font-bold text-gray-300 tracking-widest text-[10px]">YOU</p>
                                </div>
                            </div>
                            <span class="absolute top-1 left-1/2 -translate-x-1/2 font-bold text-[8px]">N 0°</span>
                            <span class="absolute right-1 top-1/2 -translate-y-1/2 font-bold text-[8px]">E 90°</span>
                            <span class="absolute left-1 top-1/2 -translate-y-1/2 font-bold text-[8px]">W 270°</span>
                            <span class="absolute bottom-1 left-1/2 -translate-x-1/2 font-bold text-[8px]">S 180°</span>

                            <canvas id="mobile-compass-vector" width="300" height="250"
                                class="absolute inset-0 w-full h-full pointer-events-none z-10"></canvas>
                            <canvas id="mobile-pencil-canvas" width="300" height="250"
                                class="absolute inset-0 w-full h-full pointer-events-none z-20"></canvas>

                            <!-- Watermark -->
                            <div
                                class="absolute bottom-1 right-2 font-serif italic text-[10px] uppercase tracking-widest opacity-30 pointer-events-none pointer-events-none z-0">
                                Range Card v1.0
                            </div>

                            <!-- Mobile Compass Details (DIR/ANG) -->
                            <div class="absolute top-1 left-1 z-30 pointer-events-none space-y-0.5">
                                <div class="flex items-center gap-1 font-bold text-[8px]">
                                    <span>DIR:</span>
                                    <div class="w-8 border-b border-black text-center min-h-[10px]">
                                        <span id="mobile-display-direction-notes" class="text-blue-800"></span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-1 font-bold text-[8px]">
                                    <span>T1:</span>
                                    <div class="w-8 border-b border-black text-center min-h-[10px]">
                                        <span id="mobile-display-shooting-angle" class="text-blue-800"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </aside>

        <!-- RIGHT PANEL: PREVIEW -->
        <main id="previewPanel"
            class="opacity-0 pointer-events-none absolute lg:opacity-100 lg:pointer-events-auto lg:relative lg:flex flex-1 bg-gray-900 overflow-y-auto p-4 lg:p-10 items-center justify-start lg:justify-center z-[50] bg-grid-pattern transition-all duration-300">
            <div id="card-scale-wrapper" class="w-full flex justify-center py-8 lg:py-0">
                <div id="card-container"
                    class="bg-white text-black w-[1000px] aspect-[4/3] shadow-2xl relative p-8 flex flex-col font-mono shrink-0 origin-top lg:origin-center">
                    <!-- Card Header -->
                    <div class="flex justify-between items-end mb-6 border-b-2 border-black pb-2">
                        <div class="flex items-center gap-8">
                            <h2 class="text-4xl font-extrabold uppercase tracking-tighter">Reload Data</h2>
                            <div class="text-xl font-bold flex items-center gap-2">
                                <span>NOTES :</span>
                                <span id="display-header-notes"
                                    class="font-handwriting text-blue-800 font-normal"></span>
                            </div>
                        </div>
                        <div class="flex flex-col items-end pb-1">
                            <span
                                class="text-[10px] font-bold text-gray-500 uppercase tracking-widest leading-none mb-1">Shooter
                                / Company</span>
                            <span id="display-shooter-name"
                                class="font-handwriting text-blue-800 font-bold text-xl leading-none"></span>
                        </div>
                    </div>

                    <!-- Main Grid -->
                    <div class="flex gap-8 h-[40%]">
                        <!-- Column 1: Load Details -->
                        <div
                            class="w-1/2 grid grid-cols-[1.4fr_0.8fr_0.8fr] gap-x-2 gap-y-1 text-[11px] font-bold content-start">
                            <div class="flex flex-col">
                                <span class="text-[8px] text-gray-500 uppercase">Timestamp</span>
                                <div class="flex gap-1 min-h-[1.2rem]">
                                    <span id="display-date" class="text-blue-800 font-normal"></span>
                                    <span class="text-gray-400">@</span>
                                    <span id="display-time" class="text-blue-800 font-normal"></span>
                                </div>
                            </div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">Zero
                                    Range</span><span id="display-zero" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Caliber</span><span id="display-caliber"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Bullet</span><span id="display-bullet"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Barrel</span><span id="display-barrel"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Powder</span><span id="display-powder"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">Load
                                    (gr)</span><span id="display-load" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">C.O.L</span><span id="display-col"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Primer</span><span id="display-primer"
                                    class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Velocity</span><span
                                    id="display-velocity" class="text-blue-800 font-normal"></span>
                            </div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Target</span><span
                                    id="display-targetSize" class="text-blue-800 font-normal"></span>
                            </div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">G-1
                                    BC</span><span id="display-g1" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col col-span-2"><span
                                    class="text-[8px] text-gray-500 uppercase">Environment</span><span
                                    id="display-weather" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span class="text-[8px] text-gray-500 uppercase">Rings
                                </span><span id="display-rings" class="text-blue-800 font-normal"></span></div>
                            <div class="flex flex-col"><span
                                    class="text-[8px] text-gray-500 uppercase">Group</span><span id="display-groupSize"
                                    class="text-blue-800 font-normal"></span>
                            </div>

                            <div
                                class="col-span-3 mt-2 grid grid-cols-2 gap-4 bg-gray-50 p-2 border border-black rounded-sm">
                                <div class="flex justify-between"><span>ELEV:</span> <span id="display-elevation"
                                        class="text-blue-800 font-bold"></span>
                                </div>
                                <div class="flex justify-between"><span>HOLD:</span> <span id="display-hold-data"
                                        class="text-blue-800 font-bold"></span>
                                </div>
                                <div
                                    class="col-span-2 flex justify-between items-center bg-black text-white px-2 py-1 mt-1">
                                    <span class="text-[10px] font-bold text-neon-green">FINAL
                                        DOPE:</span>
                                    <span id="display-final-dope" class="text-lg font-bold"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Column 2: Equipment Icons -->
                        <div class="w-1/4 flex flex-col gap-2">
                            <div class="item-note flex items-center gap-2 border border-black p-1 min-h-[2.5rem]">
                                <img src="https://img.icons8.com/ios-filled/50/000000/sniper-rifle.png" alt="Rifle"
                                    class="w-5 h-5 opacity-40">
                                <span id="display-rifle-notes" class="text-[10px]"></span>
                            </div>
                            <div class="item-note flex items-center gap-2 border border-black p-1 min-h-[2.5rem]">
                                <i data-lucide="wind" class="w-4 h-4 text-gray-400"></i> <span id="display-wind-notes"
                                    class="text-[10px]"></span>
                            </div>
                            <div class="item-note flex items-center gap-2 border border-black p-1 min-h-[2.5rem]">
                                <i data-lucide="crosshair" class="w-4 h-4 text-gray-400"></i> <span
                                    id="display-scope-notes" class="text-[10px]"></span>
                            </div>
                            <div class="item-note flex items-center gap-2 border border-black p-1 min-h-[2.5rem]">
                                <i data-lucide="binoculars" class="w-4 h-4 text-gray-400"></i> <span
                                    id="display-lrf-notes" class="text-[10px]"></span>
                            </div>
                            <div class="item-note flex items-center gap-2 border border-black p-1 min-h-[2.5rem]">
                                <i data-lucide="compass" class="w-4 h-4 text-gray-400"></i> <span
                                    id="display-compass-range" class="text-[10px]"></span>
                            </div>
                        </div>

                        <!-- Column 3: Reticles -->
                        <div class="flex-1 flex gap-2">
                            <div class="flex-1 text-center">
                                <p class="text-[10px] font-bold mb-1">HOLD</p><canvas id="canvas-hold" width="200"
                                    height="200" class="border border-black rounded-full bg-white"></canvas>
                            </div>
                            <div class="flex-1 text-center">
                                <p class="text-[10px] font-bold mb-1">SHOT</p><canvas id="canvas-shot" width="200"
                                    height="200" class="border border-black rounded-full bg-white"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom Grid -->
                    <div class="flex-1 flex gap-4 mt-4 overflow-hidden">
                        <!-- Range Table -->
                        <div class="w-1/3 border-2 border-black flex flex-col overflow-hidden">
                            <div class="grid grid-cols-4 bg-black text-white font-bold text-center text-[10px] py-1">
                                <div class="border-r border-gray-600">CLICKS</div>
                                <div class="col-span-2 border-r border-gray-600">RANGE</div>
                                <div>UD-LR</div>
                            </div>
                            <div id="distance-table-body" class="flex-1 flex flex-col text-[10px] font-bold">
                                <!-- Injected by script -->
                            </div>
                        </div>

                        <!-- Compass -->
                        <div class="flex-1 relative border border-black bg-gray-50/50 p-2 overflow-hidden">
                            <span class="absolute top-1 left-1/2 -translate-x-1/2 font-bold text-[10px]">N
                                0°</span>
                            <span
                                class="absolute right-1 top-1/2 -translate-y-1/2 font-bold text-[10px] flex gap-1 items-center">90°
                                E</span>
                            <span
                                class="absolute left-1 top-1/2 -translate-y-1/2 font-bold text-[10px] flex gap-1 items-center">W
                                270°</span>
                            <span class="absolute bottom-1 left-1/2 -translate-x-1/2 font-bold text-[10px]">S
                                180°</span>

                            <div class="absolute top-2 left-2 z-30 pointer-events-none space-y-1">
                                <div class="flex items-center gap-2 font-bold text-[10px]">
                                    <span>DIR:</span>
                                    <div class="w-16 border-b border-black text-center min-h-[12px]">
                                        <span id="display-direction-notes" class="text-blue-800"></span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 font-bold text-[10px]">
                                    <span>ANG:</span>
                                    <div class="w-16 border-b border-black text-center min-h-[12px]">
                                        <span id="display-shooting-angle" class="text-blue-800"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="absolute inset-0 flex items-center justify-center pointer-events-none z-0">
                                <div
                                    class="w-32 h-32 border border-gray-200 rounded-full flex items-center justify-center">
                                    <p class="font-bold text-gray-300 tracking-widest">YOU</p>
                                </div>
                            </div>
                            <canvas id="compass-vector" width="300" height="300"
                                class="absolute inset-0 w-full h-full pointer-events-none z-10"></canvas>
                            <canvas id="pencil-canvas" width="300" height="300"
                                class="absolute inset-0 w-full h-full pointer-events-none z-20"></canvas>
                        </div>
                    </div>

                    <div class="absolute bottom-2 right-4 font-serif italic text-xl tracking-widest opacity-20">
                        RANGE
                        CARD
                        v1.0</div>
                </div>
        </main>
    </div>
    </div>
    </div>
    </div>
    </div>

    <!-- LIBRARY MODAL -->
    <div id="libraryModal"
        class="fixed inset-0 bg-black/95 backdrop-blur-md z-[100] hidden flex items-center justify-center p-4">
        <div
            class="bg-gray-900 border border-gray-700 w-full max-w-5xl h-[90vh] rounded-xl shadow-[0_0_100px_rgba(34,197,94,0.1)] flex flex-col overflow-hidden">
            <!-- Header -->
            <div class="p-4 border-b border-gray-800 flex justify-between items-center bg-black/30 shrink-0">
                <div class="flex items-center gap-3">
                    <i data-lucide="database" class="w-5 h-5 text-neon-green"></i>
                    <div>
                        <h2 class="text-lg font-bold uppercase tracking-tight leading-none text-white">
                            Profile
                            Repository</h2>
                        <span class="text-[9px] text-gray-500 font-mono uppercase">Local Storage
                            Records</span>
                    </div>
                </div>
                <button id="closeLibraryBtn" class="p-2 hover:bg-gray-800 rounded-lg group transition-all">
                    <i data-lucide="x" class="w-6 h-6 text-gray-500 group-hover:text-white transition-colors"></i>
                </button>
            </div>

            <!-- Content Area -->
            <div class="flex-1 flex flex-col lg:flex-row overflow-hidden">
                <!-- Sidebar List -->
                <div
                    class="w-full lg:w-80 border-b lg:border-b-0 lg:border-r border-gray-800 flex flex-col bg-black/20 shrink-0 h-1/3 lg:h-full">
                    <div class="p-4 border-b border-gray-800 bg-gray-950/20">
                        <p class="text-[10px] font-bold text-gray-600 uppercase tracking-widest">Saved
                            Profiles</p>
                    </div>
                    <div id="libraryList" class="flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1">
                        <!-- Profiles list here -->
                    </div>
                </div>

                <!-- Preview Pane -->
                <div class="flex-1 flex flex-col relative bg-gray-950">
                    <!-- Empty State -->
                    <div id="noSelection"
                        class="absolute inset-0 flex flex-col items-center justify-center text-center p-12">
                        <i data-lucide="layout-template" class="w-16 h-16 text-gray-800 mb-4 stroke-1"></i>
                        <p class="text-gray-600 font-mono text-xs uppercase tracking-[0.3em]">Load a
                            specific record to
                            view details</p>
                    </div>

                    <div id="profilePreview" class="absolute inset-0 flex flex-col hidden z-10">
                        <!-- Profile Header area -->
                        <div
                            class="p-5 bg-black/60 border-b border-gray-800 flex justify-between items-center shrink-0">
                            <div class="min-w-0">
                                <h3 id="previewName"
                                    class="text-2xl font-black text-white uppercase truncate leading-none mb-1">
                                    ---</h3>
                                <p id="previewCaliber"
                                    class="text-neon-green font-mono text-[10px] uppercase truncate tracking-wide">
                                    ---
                                </p>
                            </div>
                            <div class="flex items-center gap-4 shrink-0">
                                <div class="flex bg-black/80 rounded border border-gray-700 p-0.5">
                                    <button id="viewImageBtn"
                                        class="px-4 py-1.5 text-[10px] font-bold uppercase rounded transition-all">Report</button>
                                    <button id="viewDataBtn"
                                        class="px-4 py-1.5 text-[10px] font-bold uppercase rounded transition-all">Data</button>
                                </div>
                                <div class="text-right border-l border-gray-800 pl-4">
                                    <p class="text-[8px] text-gray-500 font-bold uppercase">Record Date
                                    </p>
                                    <p id="prevDate" class="text-xs text-gray-400 font-mono italic leading-none">---
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Main Screen Area -->
                        <div class="flex-1 relative overflow-hidden bg-black/40">
                            <!-- Visual Snapshot -->
                            <div id="snapshotPreview"
                                class="absolute inset-0 overflow-auto custom-scrollbar p-10 flex flex-col items-center">
                                <div id="noImageMsg" class="mt-20 text-gray-700 font-mono text-xs uppercase hidden">No
                                    visual snapshot saved</div>
                                <img id="prevImage" src=""
                                    class="shadow-2xl border border-gray-700 bg-white max-w-full">
                            </div>

                            <!-- Data Grid View -->
                            <div id="dataPreview"
                                class="absolute inset-0 overflow-y-auto custom-scrollbar hidden p-10 bg-gray-900">
                                <div class="max-w-3xl mx-auto space-y-10">
                                    <div class="border-b border-gray-800 pb-2">
                                        <div class="flex justify-between items-end">
                                            <div class="flex-1">
                                                <label
                                                    class="text-[10px] text-neon-green font-bold uppercase mb-2 block">Header
                                                    Information</label>
                                                <p id="prevHeaderNotes"
                                                    class="text-sm text-gray-300 italic leading-relaxed">---</p>
                                            </div>
                                            <div class="text-right">
                                                <label
                                                    class="text-[9px] text-gray-500 font-bold uppercase block">Shooter /
                                                    Company</label>
                                                <p id="prevShooter"
                                                    class="text-xs text-white font-bold uppercase tracking-wider">---
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-3 gap-8">
                                        <div class="border-l border-gray-700 pl-3">
                                            <p class="text-[9px] text-gray-500 uppercase font-bold">
                                                Velocity</p>
                                            <p id="prevVel" class="text-xl font-mono text-blue-400 font-bold mt-1">
                                                ---
                                            </p>
                                        </div>
                                        <div class="border-l border-gray-700 pl-3">
                                            <p class="text-[9px] text-gray-500 uppercase font-bold">Zero
                                                Range</p>
                                            <p id="prevZero" class="text-xl font-mono text-blue-400 font-bold mt-1">
                                                ---
                                            </p>
                                        </div>
                                        <div class="border-l border-gray-700 pl-3">
                                            <p class="text-[9px] text-gray-500 uppercase font-bold text-neon-green">
                                                Final Dope</p>
                                            <p id="prevFinal" class="text-xl font-mono text-neon-green font-bold mt-1">
                                                ---</p>
                                        </div>
                                    </div>

                                    <!-- Tactical Grid -->
                                    <div
                                        class="grid grid-cols-3 gap-4 bg-black/40 p-4 rounded-lg border border-gray-800">
                                        <div class="space-y-1">
                                            <p class="text-[8px] text-gray-500 uppercase font-bold">
                                                Timestamp</p>
                                            <p id="prevTime" class="text-xs text-gray-300 font-mono">---
                                            </p>
                                        </div>
                                        <div class="space-y-1">
                                            <p class="text-[8px] text-gray-500 uppercase font-bold">
                                                Elevation Corr.</p>
                                            <p id="prevElev" class="text-xs text-gray-300 font-mono">---
                                            </p>
                                        </div>
                                        <div class="space-y-1">
                                            <p class="text-[8px] text-gray-500 uppercase font-bold">Hold
                                                Over</p>
                                            <p id="prevHold" class="text-xs text-gray-300 font-mono">---
                                            </p>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-2 gap-10">
                                        <div class="space-y-4">
                                            <div class="bg-black/30 p-4 rounded-lg border border-gray-800">
                                                <p
                                                    class="text-[10px] text-gray-400 font-bold uppercase mb-2 border-b border-gray-800 pb-1">
                                                    Load Specifications</p>
                                                <div class="space-y-1 text-[11px] font-mono">
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>Barrel:</span> <span id="prevBarrel">---</span>
                                                    </div>
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>Powder:</span> <span id="prevPowder">---</span>
                                                    </div>
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>Charge:</span> <span id="prevLoad">---</span>
                                                    </div>
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>C.O.L:</span> <span id="prevCOL">---</span>
                                                    </div>
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>Rings:</span> <span id="prevRings">---</span>
                                                    </div>
                                                    <div class="flex justify-between border-b border-gray-800/30">
                                                        <span>G1 BC:</span> <span id="prevG1">---</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="p-2">
                                                <p class="text-[10px] text-gray-500 uppercase font-bold mb-2">
                                                    Observations</p>
                                                <p id="prevRifleNotes" class="text-[11px] text-gray-400 italic">---</p>
                                            </div>
                                        </div>
                                        <div class="space-y-4">
                                            <div class="bg-black/30 p-4 rounded-lg border border-gray-800">
                                                <p
                                                    class="text-[10px] text-gray-400 font-bold uppercase mb-2 border-b border-gray-800 pb-1">
                                                    Ballistic Reference</p>
                                                <div id="prevDistanceTable"
                                                    class="grid grid-cols-2 gap-x-4 gap-y-1 text-[10px] font-mono">
                                                    <!-- Table injected -->
                                                </div>
                                            </div>
                                            <div class="p-2">
                                                <p class="text-[10px] text-gray-500 uppercase font-bold mb-2">
                                                    Environment</p>
                                                <p id="prevWeather" class="text-[11px] text-gray-400 italic">---</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Footer Actions -->
                        <div id="previewActions"
                            class="p-5 bg-black/80 border-t border-gray-800 flex gap-4 shrink-0 mt-auto">
                            <button id="loadSelectedBtn"
                                class="flex-1 bg-neon-green text-black font-extrabold py-4 rounded-lg hover:bg-green-400 shadow-[0_4px_15px_rgba(34,197,94,0.3)] transition-all uppercase tracking-widest text-xs flex items-center justify-center gap-3 active:translate-y-0.5">
                                <i data-lucide="upload-cloud" class="w-5 h-5"></i>
                                Inject into Main Form
                            </button>
                            <button id="deleteSelectedBtn"
                                class="px-8 bg-black hover:bg-red-900 border border-gray-800 hover:border-red-600 text-gray-600 hover:text-white py-4 rounded-lg transition-all text-[11px] font-bold uppercase flex items-center justify-center gap-2 group">
                                <i data-lucide="trash-2"
                                    class="w-4 h-4 text-gray-700 group-hover:text-white transition-colors"></i>
                                Trash Record
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Copyright Notice -->
    <div class="text-center py-4 bg-gray-900/50 border-t border-gray-800">
        <p class="text-[10px] text-gray-500 font-handwriting">
            &copy; 2026 Ralph Mccabe. All Rights Reserved.
        </p>
    </div>

    <script src="original_script.js"></script>
    <script> lucide.createIcons(); </script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => { /* console.log('Service Worker registered') */ })
                    .catch(err => {
                        if (window.location.protocol !== 'file:') {
                            console.log('Service Worker registration failed', err);
                        }
                    });
            });
        }
    </script>
</body>

</html>